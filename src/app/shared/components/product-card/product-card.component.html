@if (loading) {
  <!-- ðŸ”¹ Skeleton Loader -->
  <div
    class="card relative flex flex-col w-full min-h-[350px] max-h-[409px] rounded-[12px] shadow-md bg-white overflow-hidden"
  >
    <p-skeleton width="100%" height="300px" class="rounded-t-[12px]"></p-skeleton>

    <div class="product-details flex flex-col flex-1 p-3 relative min-h-[100px]">
      <p-skeleton width="80%" height="28px" class="mb-2 rounded-md"></p-skeleton>

      <div class="flex items-center mt-1 space-x-2">
        <p-skeleton width="20px" height="20px" shape="circle"></p-skeleton>
        <p-skeleton width="40px" height="20px" class="rounded-md"></p-skeleton>
        <p-skeleton width="30px" height="20px" class="rounded-md"></p-skeleton>
      </div>

      <p-skeleton width="50%" height="32px" class="mt-4 rounded-md"></p-skeleton>
      <p-skeleton width="30%" height="20px" class="mt-1 rounded-md"></p-skeleton>

      <div
        class="absolute bottom-2 right-2 rounded-lg"
        style="width: 30px; height: 30px"
      >
        <p-skeleton width="100%" height="100%"></p-skeleton>
      </div>
    </div>
  </div>
} @else {
  <!-- ðŸ”¹ Product Card -->
  <div
    class="card relative flex flex-col w-full min-h-[350px] max-h-[409px] 
    rounded-[12px] shadow-md bg-white overflow-hidden
    hover:shadow-lg hover:-translate-y-1 transition duration-300 ease-out"
  >
    <div
      class="cursor-pointer"
      [routerLink]="['/products/details', product.slug, product.id]"
    >
      <!-- Image -->
      <div
        class="relative w-full h-[300px] overflow-hidden rounded-t-[12px] bg-bg-main"
      >
        @if(imageLoading) {
          <p-skeleton
            width="100%"
            height="100%"
            class="absolute top-0 left-0 w-full h-full rounded-t-[12px] z-10"
          ></p-skeleton>
        }

        <img
          [src]="product.imageCover"
          [alt]="product.title"
          class="w-full h-full object-contain transition-opacity duration-500"
          loading="lazy"
          [class.opacity-0]="imageLoading"
          (load)="onImageLoad()"
        />

        <!-- Discount Badge -->
        @if (product.priceAfterDiscount) {
          <div
            class="absolute bottom-2 left-2 bg-main text-white font-semibold rounded 
            flex items-center justify-center text-[10px] px-2 py-1 
            sm:text-xs sm:px-2.5 md:text-sm md:px-3 lg:text-base"
          >
            -{{ calculateDiscount(product.price, product.priceAfterDiscount) }}%
          </div>
        }

        <!-- Like Button -->
        <div
          class="likeBtn drop-shadow-[0_0_5.66px_rgba(0,0,0,0.1)] bg-white text-main 
          text-sm sm:text-lg md:text-xl size-7 sm:size-8 md:size-9 flex justify-center 
          items-center absolute top-2 right-2 rounded-full hover:scale-110 transition"
        >
          <i class="far fa-heart"></i>
        </div>
      </div>

      <!-- Details -->
      <div class="product-details flex flex-col flex-1 p-3 relative">
        <p
          class="text-sm sm:text-base md:text-lg lg:text-xl font-medium text-text line-clamp-1"
        >
          {{ product.title }}
        </p>

        <div class="flex items-center mt-1">
          <i class="fas fa-star text-main mr-1 text-xs sm:text-sm"></i>
          <span class="text-sm sm:text-base font-medium">
            {{ product.ratingsAverage }}
          </span>
          <span class="text-xs sm:text-sm text-grey-2 ml-1">
            ({{ product.ratingsQuantity }}+)
          </span>
        </div>

        <p class="text-main text-base sm:text-lg md:text-xl font-semibold">
          {{ product.priceAfterDiscount || product.price }} EGP
          @if (product.priceAfterDiscount) {
            <span class="text-grey-2 line-through ml-1 text-xs sm:text-sm">
              {{ product.price }} EGP
            </span>
          }
        </p>
      </div>
    </div>

    <!-- Add to Cart -->
    <button
      class="addToCart absolute bottom-2 right-2 bg-main text-white rounded-[10px] 
      size-7 sm:size-8 md:size-9 max-[425px]:size-6 flex items-center justify-center 
      drop-shadow-[0_0_48px_rgba(0,0,0,0.8)] hover:bg-main/90 hover:scale-105 
      transition duration-300"
    >
      <i class="fas fa-plus text-xs sm:text-sm md:text-base"></i>
    </button>
  </div>
}
